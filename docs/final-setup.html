<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Final setup · Large Quadcopter Build</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;Here we&#x27;ll just do some final setup to:&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Final setup · Large Quadcopter Build"/><meta property="og:type" content="website"/><meta property="og:url" content="https://george-hawkins.github.io/arf-drone/index.html"/><meta property="og:description" content="&lt;p&gt;Here we&#x27;ll just do some final setup to:&lt;/p&gt;
"/><meta property="og:image" content="https://george-hawkins.github.io/arf-drone/img/og-image.png"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/arf-drone/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/arf-drone/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/arf-drone/"><img class="logo" src="/arf-drone/img/header-icon.svg" alt="Large Quadcopter Build"/><h2 class="headerTitleWithLogo">Large Quadcopter Build</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Build</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Build</h3><ul><li class="navListItem"><a class="navItem" href="/arf-drone/docs/INTRO">Introduction</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/parts">Parts</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/purchase-order">Purchase Order</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/battery-charging">Batteries</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/transmitter-getting-started">Transmitter - Getting Started</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/stick-setup">Stick setup</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/transmitter-model-setup">Transmitter - Model Setup</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/transmitter-flight-modes">Transmitter - Flight Modes</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/receiver">Receiver</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/electronics-assembly">Assembling the electronics</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/binding">Binding the receiver</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/pixhawk-setup">Pixhawk setup</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/frame-parts">F450 frame kit</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/pdb-soldering">Soldering the PDB</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/frame-assembly">Frame assembly</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/final-assembly">Final assembly</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/build-2/build-2">Final assembly</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/arf-drone/docs/final-setup">Final setup</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Appendices</h3><ul><li class="navListItem"><a class="navItem" href="/arf-drone/docs/pixhawk-leds">Pixhawk LEDs</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/pixhawk-tones">Pixhawk tones</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/pixhawk-driver">Pixhawk Windows device driver</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/transmitter-extras">Transmitter extras</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/soldering">Soldering</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/stores">Stores</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/windows-vm">Windows VM</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/opentx-companion-on-ubuntu">OpenTX Companion on Ubuntu</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/qgroundcontrol">QGroundControl</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/notes">Notes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">FPV quad</h3><ul><li class="navListItem"><a class="navItem" href="/arf-drone/docs/eachine-qx95">Eachine QX95</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/inprogress-qx95">Inprogress QX95</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/cleanflight-settings/cleanflight-settings-README">Cleanflight Settings README</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/fpv-x-racer">X-racer notes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Followup projects</h3><ul><li class="navListItem"><a class="navItem" href="/arf-drone/docs/video">Video</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/telemetry">Telemetry</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Miscellaneous</h3><ul><li class="navListItem"><a class="navItem" href="/arf-drone/docs/snippets">Snippets</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/antenna-mount/antenna-mount-README">Antenna mount</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/antenna-mount/version-1/antenna-mount-v1-README">Antenna mount - version 1</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/antenna-mount/version-2/antenna-mount-v2-README">Antenna mount - version 2</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/f450-dimensions">F450 dimensions</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/gps-mast-placement">GPS mast placement</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/notes-to-self">Notes to self</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/pages-and-videos">Pages and videos</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/power-module-xt60-to-deans">Power module - XT60 To Deans</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/receiver-power">Receiver power</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/receiver-windows-upgrade">Receiver Windows upgrade</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/rx8r">Inside the RX8R</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/unused-parts">Unused parts</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/vibration-damping-platform">Vibration damping</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/voice">OpenTX sounds</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/sounds">Flight mode sounds</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/case">Case</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/foam-outline/foam-outline-README">Foam Outline README</a></li><li class="navListItem"><a class="navItem" href="/arf-drone/docs/20181021-rebuild-params/20181021-rebuild-params-README">20181021 Rebuild Params README</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/george-hawkins/arf-drone/edit/docusaurus/docs/final-setup.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">Final setup</h1></header><article><div><span><p>Here we'll just do some final setup to:</p>
<ul>
<li>Display telemetry data on the transmitter.</li>
<li>Add alarms for low and critical radio signal and battery conditions.</li>
<li>Enable auto-tuning.</li>
<li>Look at auto-trim.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="telemetry"></a><a href="#telemetry" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Telemetry</h2>
<p>If you long press <em>PAGE</em> from the main screen you get to the telemetry screens. If the receiver is off then all you'll see is &quot;No Telemetry Screens&quot;, the top bar shows the currently selected model and the current voltage of the transmitter's batteries.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/01-no-setup.png" alt="no setup"></p>
<p>Plug the Pixhawk in to USB (there's no need to connect the main LiPo battery). This will provide power to the receiver. Now (without you needing to configure anything) it will start displaying the <a href="https://en.wikipedia.org/wiki/Received_signal_strength_indication">RSSI</a> (received signal strength indication). This tells you how strong the radio link between the receiver and the transmitter is. If you walk around with the transmitter you should the value increase and decrease as you'd expect. However when you get within about 2m things get a little odder as various affects kick-in due to the receiver and transmitter being too close together.</p>
<p>TODO: this should be explained way earlier as people get confused by the &quot;telemetry lost&quot; / &quot;telmetetry recover&quot; (yes it's &quot;recover&quot; and not &quot;recovered&quot;). Can I find a good explanation for the &quot;saturation&quot; affect when RX and TX are close.</p>
<p>TODO: I tried to get a good explanation of why RSSI behaves strangely when the RX and TX are in close proximity - there's lots of fairly random unconvincing explanations on the web. I asked on the OpenTX rocket chat but just got &quot;I believe it's nothing more than the short distance causing a signal overload on the RX frontend.&quot; (see <a href="https://opentx.rocket.chat/channel/OpenTX_General?msg=zeD5EoF765crgjuHR">here</a>). This seems the most common explanation that there's some kind of signal swamping issue.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/02-no-setup-rssi.png" alt="no setup-rssi"></p>
<p>If you walk very far away then you'll hear the transmitter announce &quot;RF signal low&quot; (and the RSSI bar will turn from solid black to a checkered pattern). If you go even further it will announce &quot;RF signal critical&quot;. It'll repeat these warning every 10 seconds while the signal remains low (or critical).</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/03-no-setup-lo-rssi.png" alt="no setup lo rssi"></p>
<p>So you get the RSSI value displayed as a bar and low and critical alarms without having to set up anything. The same isn't true of any other telemetry values - in particular the telemetry data from the FrSKY voltage sensor. This has to be setup explicitly. Make sure the voltage sensor is plugged in.</p>
<p><img src="assets/images/assembly/final-setup/rx-and-flvss.jpg" height="512"></p>
<p>Now on your transmitter go to the <em>Model selection</em> screen and long press <em>PAGE</em> twice to get to <em>Telemetry</em>, scroll down to <em>Discover new sensors</em> and press <em>ENTER</em>. It should detect the <em>Cels</em>, <em>RSSI</em> and <em>RxBt</em> telemetry values being transmitted by the receiver. An asterisk should flash on and off beside the <em>RSSI</em> and <em>RxBt</em> values showing that updated values for these are being received continuously.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/04-discover.png" alt="discover"></p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/05-discover-flvss.png" alt="discover flvss"></p>
<p><em>Cels</em> is the value coming from the voltage sensor - initially its value shows as <code>---</code> but plug the sensor into the balance connector of the battery and it'll start generating data.</p>
<p><img src="assets/images/assembly/final-setup/rx-and-flvss-and-bat.jpg" height="512"></p>
<p>You can see that the basic <em>Cels</em> value is the total voltage of the battery - but what we're really interested in is the voltage of the individual cells, in particular the lowest voltage one. It's crucial that the voltage of no one cell drops too low. We'll come back to this later - but for the moment will just work with the total battery voltage.</p>
<p>Press <em>Stop discovery</em> and then press <em>PAGE</em> to get to <em>Display</em>.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/06-discover-flvss-bat.png" alt="discover flvss bat"></p>
<p>Here we can configure what's seen on the telemetry screens. Select <em>None</em> for <em>Screen 1</em> and change it to <em>Nums</em>. You can also choose to display values as bars but this involves a bit more setup as you have to set low and high range for each item you want to display.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/07-display.png" alt="display"></p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/08-display-nums.png" alt="display nums"></p>
<p>Now go down and add items to five of the <code>---</code> areas, when you press <em>ENTER</em> you can scroll through a list of items that can be displayed. There are all kinds of things, like throttle value etc., the interesting things are right at the end. Select the three sensors that were discovered along with <em>Batt</em> and <em>Time</em>.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/09-display-vals.png" alt="display vals"></p>
<p>Note: for <em>RSSI</em> (and many other values) there are also plus and minus variants, i.e. <em>RSSI+</em> and <em>RSSI-</em>. These can be used to show the highest and lowest seen values for RSSI, i.e. the normal <em>RSSI</em> value is updated continuously while <em>RSSI+</em> and <em>RSSI-</em> are only updated when the current RSSI value falls or rises above than the previous miniumum or maximum.</p>
<p>TODO: when are the <em>RSSI-</em> and <em>RSSI+</em> values reset - when the TX is switched on and off?</p>
<p>TODO: ask about the following on the <a href="https://www.rcgroups.com/forums/showthread.php?2823315-OpenTx-2-2">OpenTX 2.2 support thread</a>:</p>
<ol>
<li><p>The TX battery voltage is still displayed in the top bar but RSSI has disappeared from the bottom one. Why? If I remove <em>RSSI</em> as a displayed value it's still gone (i.e. it's not removed to avoid duplication). In OpenTX 2.1 you could choose the voltage source displayed in the top bar, i.e. you could switch it from the TX value to the Cels value, but this feature seems have gone from the <em>Telemetry</em> screen - has setting up the top and bottom bar moved elsewhere?</p></li>
<li><p>Note difference between RSSI that TX sees from RX and the the RSSI that the RX sees from the TX that's reported back via telemetry data. Presumably the first is what you see in the bottom bar below. Is there anyway to get &quot;TX seen RSSI&quot; as an item on the telemetry screen or is it gone forever once &quot;RX seen RSSI&quot; is available? Ask about this on some OpenTX forum.</p></li>
</ol>
<p>Now if you exit all the way back to the main screen and long press <em>PAGE</em> you see something a bit more interesting than &quot;No telemetry screens&quot;. So <em>Cels</em>, as already mentioned, is the total voltage of your craft's battery, <em>Batt</em> is the voltage of the transmitter's batteries (and just duplicates the value already seen in the top bar) and <em>RxBt</em> is the voltage of the receiver's power source. The receiver is powered via the Pixhawk that provides it with about 5V - so this value isn't directly related to any battery and isn't very interesting.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/10-telemetry.png" alt="telemetry"></p>
<p>So we've seen the varous voltage source values we can display - as <em>Batt</em> is already shown in the top bar and <em>RxBt</em> isn't very relevant let's remove them on the <em>Display</em> screen and then return to the cleaned up telemetry screen.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/11-less-vals.png" alt="less vals"></p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/12-less-telemetry.png" alt="less telemetry"></p>
<p>The voltage of the lowest voltage cell is more important than the total voltage. To get this we have to go back to the <em>Telemetry</em> screen and manually add a new sensor (that's actually derived from secondary data provided by the <em>Cels</em> sensor but not yet displayed). Select <em>Add a new sensor</em>.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/13-add-new-sensor.png" alt="add new-sensor"></p>
<p>Then enter an appropriate name, e.g. &quot;LoCe&quot; (it can be a maximum of four letters), set <em>Type</em> to <em>Calculated</em>, <em>Formula</em> to <em>Cell</em> and <em>Cell sensor</em> to the name of our sensor, i.e. <em>Cels</em>, and set set <em>Cell index</em> to <em>Lowest</em>.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/14-lowest-cell.png" alt="lowest cell"></p>
<p>On exiting out we now see LoCe as an additional sensor. You can add more sensors, just like above but with different <em>Cell index</em> values, e.g. 1 to 4 for the specific cells or <em>Highest</em> for the highest voltage cell or <em>Delta</em> for the difference between the highest and the lowest voltage cell (to give you a measure of how balanced the cells in your battery are). For the moment we'll just stick with LoCe.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/15-loce-added.png" alt="loce added"></p>
<p>You can now add LoCe to the displayed values and see it on your telemetry screen.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/16-display-loce.png" alt="display loce"></p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/17-telemetry-loce.png" alt="telemetry loce"></p>
<h2><a class="anchor" aria-hidden="true" id="low-rssi-alarm"></a><a href="#low-rssi-alarm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Low RSSI alarm</h2>
<p>We don't have to do anything to set up audio alerts for low and critical RSSI values - this is done automatically. If you were looking carefully on the <em>Telemetry</em> screen you'd have seen the <em>Low alarm</em> and <em>Critical alarm</em> values for RSSI - the defaults seem to be considered good (45 and 42 respectively).</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/rssi-alarm.png" alt="RSSI alarm"></p>
<p>As noted above if you take the transmitter and walk away from your receiver, watching the RSSI value getting smaller and smaller, you will eventually hear the &quot;RF signal low&quot; and then the &quot;RF signal critical&quot; audio alerts. Or if you live in a small apartment (like mine) where the RSSI never drops to 45, no matter where transmitter and receiver are, you can simply temporarily alter the low and critical levels to e.g. 75 (the maximum settable level) and 70 respectively to test things out.</p>
<h2><a class="anchor" aria-hidden="true" id="low-battery-alarm"></a><a href="#low-battery-alarm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Low battery alarm</h2>
<p>Surprisingly there isn't a similarly simple default setup for warning on low battery voltage. Instead we have to set up a logical switch that turns on when the value of LoCe falls below a particular value. Then we use this logical switch to trigger an audio alert.</p>
<p>So go to the <em>Logical switches</em> screen, scroll down to a free slot, long press <em>ENTER</em> and select <em>Edit</em>. Then for the <em>Func</em> select <em>a&lt;x</em>, then select LoCe and 3.5V for the <em>V1</em> and <em>V2</em> values respectively and choose a <em>Delay</em> of 3 seconds.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/18-logical-low.png" alt="logical low"></p>
<p>The 3 second delay means that the condition has to hold for at least 3 seconds - this avoids the switch being triggered for temporary voltage drops - these happen e.g. when you suddenly apply a lot of throttle.</p>
<p>Most web pages are fairly consistent in giving 3.3V as the value at which the battery voltage will start to drop very rapidly and is the point at which you should stop flying, however there's more variance as to what constiutes the low point before this at which you should start thinking of wrapping up a session with a paricular battery. I've chosen 3.5V and this seems fairly common.</p>
<p>So we've setup a logical switch to trigger at 3.5V, setup another to trigger at 3.3V.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/19-logical-switches.png" alt="logical switches"></p>
<p>Now that we have two logical switches, that will trigger at our low and critical voltage values, go to the <em>Special Functions</em> screen and add two additional functions that link these logical switches to the <em>Play track</em> function. Select the <em>lowbat</em> track for the 3.5V triggered switch and the <em>batcrt</em> track for the 3.3V triggered switch.</p>
<p>Note: <em>batcrt</em> isn't part of the standard OpenTX SD card contents and comes from the sounds in <code>opentx-extra-tracks.zip</code> that we installed previouly when setting up sounds for the flight modes.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/20-special-functions.png" alt="special functions"></p>
<p>You can then test that the audio alert really gets triggered by going back and editing one of the logical switches, temporarily increase the <em>V2</em> value to e.g. 4V and just leave it for the delay period (3 seconds), you don't have to exit out of editing. If all goes well you should hear the expect track - if all goes well return <em>V2</em> to its proper value.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/21-trigger-low.png" alt="trigger low"></p>
<p>Unlike the RSSI alarm, these alarms will only sound once rather than repeating every 10 seconds. Getting sounds to repeat is easy - on the <em>Special Functions</em> screen just change the <code>-</code> (that you see at the end of the <code>L7</code> and <code>L8</code> lines above) to 10 (seconds). However this isn't enough - once the battery voltage drops below the low threshold then the low battery alert will continue repeating even once the voltage drops below the critical voltage threshold. To avoid this you'd have to make the low logical switch dependent on the critical one not being active.</p>
<p>Instead a more useful optional extra here is to make the low and critical logical switches dependent on their being any voltage at all being reported! If you add the above logical switches you'll quickly notice that the transmitter announces the low and critical battery alerts whenever you've e.g. got things hooked up to MP and are just powering the craft via USB rather than via the battery. To disable this annoying behavior add a new logical switch that becomes active only if the voltage is above 0 and then make the existing low and critical logical switches dependent on this switch being active.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/loce-no-battery.png" alt="battery present logical switch"></p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/rssi-bat/low-bat-no-bat.png" alt="low switch dependent on battery present"></p>
<h2><a class="anchor" aria-hidden="true" id="auto-tune"></a><a href="#auto-tune" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Auto-tune</h2>
<p>The craft is continuously adjusting its behavior according to its sensors, where it is now and where it wants to be. Core to this is a set of three parameters called PID (proportional-integral-derivative) and if you get into whole drone field you'll find people can get quite obsessive about tuning these parameters to match their craft and how they want it to behave. How these parameters interact and affect things is really fairly complex - if you want a nice introduction see Bruce Simpson's <a href="https://youtu.be/0vqWyramGy8">PID video</a> and Oscar Liang's <a href="https://oscarliang.com/quadcopter-pid-explained-tuning/">explanation of PID</a>.</p>
<p>The important thing is that for the craft to be as controllable as possible and behave as well as possible in flight these parameters have to be adjusted to match the craft. So if you've built your own craft this is an issue - the flight controller software uses some reasonable defaults that should work for pretty much anything but they obviously won't be the best for your craft. Tuning the PID values is a black art but the auto-tune feature of ArduCopter can help you out by finding the best values automatically.</p>
<p>To do this it puts your craft through quite a prolonged sequence of exercises, twitching it this way and that, comparing what should ideally have happened with what the sensors report actually did happen. Using the data gathered in this way it works out what it thinks should be the ideal PID values.</p>
<p>Once you've set things up to enable auto-tune (as described below) you just need to go out on a low wind day, point the craft into the wind (if there is any), go to the <em>AltHold</em> flight mode, flick the <em>SC</em> switch into its middle position and then follow the remaining instructions on the <a href="http://ardupilot.org/copter/docs/autotune.html">auto-tune page</a> that cover invoking auto-tune.</p>
<p>TODO: pointing the craft into the wind assumes that when tuning all axes (as we are) that it starts on the roll axis, see if it twiches left first - if it does this is the case.</p>
<p>Note: the auto-tune instructions mention setting the <code>AUTOTUNE_AXES</code> and <code>AUTOTUNE_AGGR</code> parameters, however their default values, 7 (all axes) and 0.1 (aggresive), are already the most appropriate values and shouldn't need to be changed.</p>
<p>Setting up auto-tune is simple - we want to set the <em>SC</em> switch of the transmitter so that when it's flipped to its middle position it sets the transmitter's channel 7 value high (and plays a track to tell us we're in auto-tune mode) and in MP we want to configure the flight controller to interpret channel 7 going high as the trigger to enter auto-tune mode.</p>
<p><em>Upper right switches.</em>  <br>
<img width="256" src="assets/images/assembly/transmitter/upper-right-switches.png"></p>
<p>On the transmitter go to <em>Special functions</em> and add two new special functions, both of which are activated when <em>SC</em> is in its middle position, i.e. <em>SC-</em>. The first special function should be set to override channel 7 and set its value to 100% (make sure to remember to tick the enabled box - it defaults to disabled) and the second one should play the track <code>attnmd</code>, i.e. it'll announce &quot;auto tune mode&quot;. There's a note later on using a mix rather than a special funtion to change the value of channel 7 - but the special function approach is very simple, so we'll stick with it here.</p>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/tuning/auto-tune-special-functions.png" alt="auto-tune special functions"></p>
<p>Set up in MP is just as trivial - just make sure your craft is connected, go to <em>Config/Tuning</em>, then to <em>Standard Params</em> and use <em>Find</em> to search for paramters containing the word &quot;channel&quot;. Then select <em>AutoTune</em> from the dropdown for <em>CH7_OPT</em>. The only confusing thing (as noted before) is that the layout means that it looks like the dropdown for <em>CH7_OPT</em> is the one immediately above it, but actually its the one below it, separated from it by some blank space.</p>
<p><img src="/arf-drone/docs/assets/images/mission-planner/autotune/standard-params-channels.png" alt="standard params channels"></p>
<p>That's it done. The next few screenshots are just about confirming that things are setup properly. But first make sure your transmitter is turned on. A convenient way to see the currently selected flight mode and the channel values for channels 1 to 8 is to go to <em>FailSafe</em>. Flip your flight mode switches to reach <em>AltHold</em> mode - you'll see the mode reported on the upper-right (and see the channel 5 value change as you flip the flight mode switches). You need to be in <em>AltHold</em> mode before you can enable <em>AutoTune</em> mode.</p>
<p><img src="/arf-drone/docs/assets/images/mission-planner/autotune/mode-via-failsafes.png" alt="mode via failsafes"></p>
<p>Now flip the switch assigned to enable <em>AutoTune</em> mode, i.e. move the <em>SC</em> switch to its middle position. You'll see the channel 7 value going high but unfortunately you don't see <em>AltHold</em> changing to <em>AutoTune</em>.</p>
<p><img src="/arf-drone/docs/assets/images/mission-planner/autotune/ch7-high.png" alt="ch7 high"></p>
<p>The only way I've found to confirm that flipping the <em>SC</em> switch did anything other than set the channel 7 value high is to instead go <em>Flight Data</em> and flip to the <em>Messages</em> tab. Now if you flip <em>SC</em> to its middle position you'll see &quot;Flight mode change failed&quot; on both the HUD and it the messages tab. So while you can change between the flight modes you configured for channel 5 even while disarmed, it seems that you cannot switch into <em>AutoTune</em> mode - but at least you can see that it tried.</p>
<p><img src="/arf-drone/docs/assets/images/mission-planner/autotune/flight-mode-change-failed.png" alt="flight mode change failed"></p>
<p>TODO: the auto-tune instrutctions also recommend enabling <a href="http://ardupilot.org/copter/docs/current-limiting-and-voltage-scaling.html">voltage scaling</a> - look into this.</p>
<h2><a class="anchor" aria-hidden="true" id="auto-trim"></a><a href="#auto-trim" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Auto-trim</h2>
<p>In addition to auto-tune mode there is auto-trim mode. Trim was already discussed briefly in relation to the transmitter - if your craft has a tendency to always drift to the right then you can correct this with the digital trim button on the transmitter that corresponds to roll so that it permanently adjusts roll slightly to the left to compensate for the rightward drift. It turns out that this trim adjustment can also be done by the flight controller.</p>
<p>If you put your craft into <a href="http://ardupilot.org/copter/docs/autotrim.html#auto-trim">auto-trim mode</a> (it needs to be a windless day) you just need to use the sticks to maintain your craft in a stable hover for 25 seconds - the flight controller will then work out from the stick movements you needed to make what trim values are needed to maintain a stable position without you having to make the corrections you did via the sticks.</p>
<p>If everything is set up properly then trim adjustments shouldn't really be necessary. Trim should not be needed to e.g. compensate for a lot of weight on the nose caused by a camera setup. Instead the flight controller should already have been calibrated such that it can work out from its sensors what's happening - if it feels it should be level but additional weight on the nose is causing it to tip forward then it will apply more power to the front motors until reality matches expectations. It's doing this kind of thing continuously, irrespective of unequal weight distribution etc.</p>
<p>TODO: can anyone provide any reason why trim should be needed even if a craft's sensors are well calibrated?</p>
<p>However if you still find your craft tending to drift in a particular direction even when the sticks are centered (and you've calibrated all the sensors) then auto-trim may be able to solve the problem. Unlike auto-tune no setup is required on your transmitter or in MP, instead auto-trim is enabled by holding the throttle stick in the arming position for 15 seconds (rather than the normal 5) and then following the instructions on the auto-trim mode page (linked to above).</p>
<p>Note: the auto-trim instructions haven't been updated since the time of the old APM flight controller, when they refer to &quot;the small red, blue and yellow LEDs&quot; they're referring to a tiny set of LEDs on the APM rather than anything on the Pixhawk.</p>
<p>TODO: wouldn't it be easier if auto-tune just involved letting the craft drift for 25 seconds (assuming its drifting is not too extreme) and then working out from the start and end GPS positions how trim needs to be adjusted - even with relatively inaccurate GPS fixes this should be fairly OK if the craft is left to drift for long enough, no?</p>
<h2><a class="anchor" aria-hidden="true" id="todo"></a><a href="#todo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>TODO</h2>
<p>See auto-tune and auto-trim snippits in misc (not added to git - on Linux box) - maybe neaten them up into a one page PDF to printout and bring with you on first flight.</p>
<h2><a class="anchor" aria-hidden="true" id="notes"></a><a href="#notes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Notes</h2>
<ul>
<li>For a nice video on setting up telemetry (discovering sensors) on the Q X7 see this <a href="https://youtu.be/Qo4Ck_vsJ6I?t=122">video</a> from Painless360 (from 2:02 onwards). And for one on displaying all the data available from your FLVSS sensor on your transmitter, including the individual cell voltages, the highest and lowest values and the difference between these two, see this <a href="https://youtu.be/lORZGjDpZEg">video</a>.</li>
<li>There are only so many tracks available in the OpenTX standard sound pack, even the larger packs that you can find in the popular  <a href="https://www.rcgroups.com/forums/showthread.php?2151914-The-Amber-Transmitter-Sound-Pack">Amber sound pack thread</a> can't cover everything. So if there isn't a track already available for something, it may be more convenient to flag the event with one of the non-specific chirps and beeps that OpenTX provides. So instead of <em>Play Track</em> you can choose <em>Play Sound</em> and then pick from sounds with names like Robot, Sci-fi, Cricket etc.</li>
</ul>
<p><img src="/arf-drone/docs/assets/images/opentx-screenshots/tuning/play-sound-special-function.png" alt="play sound special function"></p>
<ul>
<li>You can add new tracks but you can't add new sounds - there's just a limited set of them hardcoded into OpenTX. They're programmatically generated in the <code>audioEvent</code> function found in the OpenTX <a href="https://github.com/opentx/opentx/blob/2.2/radio/src/audio_arm.cpp"><code>audio_arm.cpp</code></a> file.</li>
<li>Above we just setup the <em>SC</em> switch to trigger auto tune mode directly. There are only a limited number of switches on the transmitter - if you end up wanting to trigger substantially more actions then it makes more sense to create logical switches (as we did for the flight modes). This way you can easily get easily trigger eight additional events by combining <em>SC</em> and <em>SD</em> to get 3 banks of 3 triggers, i.e. 9 possible states (where the first corresponds to nothing-triggered, leaving you with 8 triggers).</li>
<li>I used a special function to get <em>SC</em> to set the channel 7 value high. On the whole though this kind of thing should be done via mixes - I asked a question above this on RCGroups and got some nice replies, if you look at the <a href="https://www.rcgroups.com/forums/showthread.php?2979489-OpenTX-set-3-way-switch-so-its-mid-maxes-one-ch-and-down-maxes-another-%28via-mixes%29">thread</a> you can see alternative approaches to doing things with mixes rather than using a special function. The question involves using the <em>SC↓</em> position in addition to the <em>SC-</em> position used here. For this situation though a special function is good enough.</li>
</ul>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 2019-1-16</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/arf-drone/docs/build-2/build-2"><span class="arrow-prev">← </span><span>Final assembly</span></a><a class="docs-next button" href="/arf-drone/docs/pixhawk-leds"><span>Pixhawk LEDs</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#telemetry">Telemetry</a></li><li><a href="#low-rssi-alarm">Low RSSI alarm</a></li><li><a href="#low-battery-alarm">Low battery alarm</a></li><li><a href="#auto-tune">Auto-tune</a></li><li><a href="#auto-trim">Auto-trim</a></li><li><a href="#todo">TODO</a></li><li><a href="#notes">Notes</a></li></ul></nav></div></div></body></html>